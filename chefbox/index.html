---
layout: base.njk
title: "Monte sua ChefBox | Jogo 4+1"
description: "A experi√™ncia gamificada da ChefBrico. Escolha 4 e ganhe 1."
---

<!-- BARRA FIXA DO JOGO (CSS j√° definido no style.css) -->
<div class="game-bar-sticky">
    <div class="slots-container">
        <div class="slot" id="slot-1">1</div>
        <div class="slot" id="slot-2">2</div>
        <div class="slot" id="slot-3">3</div>
        <div class="slot" id="slot-4">4</div>
        <div class="slot gift" id="slot-5">üéÅ</div>
    </div>
    
    <div style="flex-grow: 1; text-align: center;">
        <div class="game-status" id="status-msg" style="color: var(--cor-institucional);">
            Escolha 4 pratos para ganhar o presente!
        </div>
    </div>

    <button id="btn-checkout" class="btn-cta-nav" style="display:none; box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);" onclick="finalizarZap()">
        FINALIZAR PEDIDO ‚ûú
    </button>
</div>

<main class="container" style="padding-top: 40px;">
    <div style="text-align:center; margin-bottom: 40px;">
        <h1>Monte sua ChefBox</h1>
        <p>Selecione seus favoritos clicando nos cart√µes abaixo.</p>
    </div>

    <!-- GRID DE PRODUTOS (Puxa autom√°tico das receitas) -->
    <div class="recipe-grid">
        {% for item in collections.receitas %}
        <!-- O 'onclick' ativa a fun√ß√£o JS abaixo -->
        <div class="recipe-card" style="cursor: pointer;" onclick="adicionarAoJogo(this, '{{ item.data.title }}', '{{ item.data.price }}')">
            <div class="card-img-container" style="height: 150px;">
                <img src="{{ item.data.image }}" alt="{{ item.data.title }}" class="card-img">
            </div>
            <div class="card-content" style="padding: 15px;">
                <h3 class="card-title" style="font-size: 1rem;">{{ item.data.title }}</h3>
                <div class="card-footer" style="margin-top: 10px; padding-top: 10px;">
                    <span class="card-price">R$ {{ item.data.price }}</span>
                    <div class="btn-buy-mini" style="background: var(--cor-cta);">+</div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</main>

<!-- L√ìGICA DO JOGO (JavaScript Embutido para garantir funcionamento) -->
<script>
    let carrinho = [];
    const MAX_ITENS = 5; // 4 Pagos + 1 Gr√°tis

    function adicionarAoJogo(elemento, nome, preco) {
        // 1. Verifica se j√° est√° cheio
        if (carrinho.length >= MAX_ITENS) {
            alert("Sua caixa j√° est√° completa! Remova um item se quiser trocar.");
            return;
        }

        // 2. Adiciona ao array
        carrinho.push({ nome: nome, preco: preco });
        
        // 3. Feedback Visual no Card (Fica meio transparente e borda verde)
        elemento.style.opacity = "0.6"; 
        elemento.style.border = "2px solid var(--cor-cta)";
        elemento.style.pointerEvents = "none"; // Impede clicar duas vezes no mesmo

        // 4. Atualiza a barra
        atualizarSlots();
    }

    function atualizarSlots() {
        const msg = document.getElementById('status-msg');
        const btn = document.getElementById('btn-checkout');

        // Preenche as bolinhas
        for (let i = 1; i <= 5; i++) {
            let slot = document.getElementById('slot-' + i);
            if (i <= carrinho.length) {
                slot.classList.add('filled');
                slot.innerText = "‚úì";
                if (i === 5) {
                    slot.classList.add('active'); // O Presente brilha
                    slot.innerText = "üéÅ";
                }
            }
        }

        // Mensagens de Incentivo
        if (carrinho.length < 4) {
            msg.innerText = `Faltam ${4 - carrinho.length} para liberar o presente!`;
        } else if (carrinho.length === 4) {
            msg.innerText = "PARAB√âNS! AGORA ESCOLHA SEU PRESENTE GR√ÅTIS üéÅ";
            msg.style.color = "var(--cor-cta)";
            msg.style.fontWeight = "bold";
        } else if (carrinho.length === 5) {
            msg.innerText = "CAIXA COMPLETA! üéâ";
            btn.style.display = "block"; // Mostra bot√£o de compra
        }
    }

    function finalizarZap() {
        let texto = "*üç≥ PEDIDO CHEFBOX (4+1)*\n\n";
        texto += "Itens Pagos:\n";
        for(let i=0; i<4; i++) texto += `‚úÖ ${carrinho[i].nome}\n`;
        
        texto += `\nüéÅ *PRESENTE:* ${carrinho[4].nome}\n`;
        texto += "\nOl√° Maria! Montei minha caixa no site e quero finalizar.";

        let link = `https://wa.me/5561996659880?text=${encodeURIComponent(texto)}`;
        window.location.href = link;
    }
</script>
