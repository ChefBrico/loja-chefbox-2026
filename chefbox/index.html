---
layout: base.njk
title: Monte sua ChefBox | Jogo 4+1
description: A experi√™ncia gamificada da ChefBrico.
---

<style>
    /* 1. CABE√áALHO FIXO GAMIFICADO */
    .game-header {
        background: white;
        padding: 15px;
        text-align: center;
        position: sticky;
        top: 0;
        z-index: 999;
        box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        border-bottom: 5px solid #e0e0e0;
        transition: border-color 0.3s;
    }
    
    /* Muda de cor quando completa a miss√£o */
    .game-header.mission-complete { border-color: #D4AF37; }

    .progress-bar {
        display: flex;
        justify-content: center;
        gap: 8px;
        margin: 10px 0;
    }

    .slot {
        width: 45px; height: 45px;
        border-radius: 50%;
        background: #f4f4f4;
        border: 2px dashed #ccc;
        display: flex; align-items: center; justify-content: center;
        font-weight: bold; color: #ccc;
        font-size: 1.1rem;
        transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Efeito Bouncy */
    }

    .slot.filled {
        background: #27ae60; color: white; border-style: solid; border-color: #219150;
        transform: scale(1.1);
        box-shadow: 0 2px 5px rgba(39, 174, 96, 0.4);
    }

    .slot-gift { border-color: #D4AF37; color: #D4AF37; }
    
    .slot-gift.active {
        background: #D4AF37; color: white; transform: scale(1.2);
        box-shadow: 0 0 15px rgba(212, 175, 55, 0.6);
        animation: pulse 1.5s infinite;
    }

    /* 2. FILTROS DE CATEGORIA (UX) */
    .category-filters {
        display: flex; gap: 10px; justify-content: center; padding: 15px; overflow-x: auto;
    }
    .filter-btn {
        padding: 8px 16px; border: 1px solid #ddd; border-radius: 20px; background: white; cursor: pointer;
        font-size: 0.9rem; white-space: nowrap;
    }
    .filter-btn.active { background: #2c3e50; color: white; border-color: #2c3e50; }

    /* 3. GRID DE PRODUTOS */
    .game-grid {
        display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 15px; padding: 0 15px 100px 15px; max-width: 1000px; margin: 0 auto;
    }

    .game-card {
        background: white; border: 1px solid #eee; border-radius: 12px;
        overflow: hidden; cursor: pointer; position: relative;
        transition: transform 0.2s;
    }
    
    .game-card:active { transform: scale(0.95); }
    
    /* Feedback visual de sele√ß√£o */
    .game-card.selected { border: 3px solid #27ae60; }
    .game-card.selected::after {
        content: '‚úî'; position: absolute; top: 5px; right: 5px;
        background: #27ae60; color: white; width: 25px; height: 25px;
        border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.8rem;
    }

    .game-card.gift-selected { border: 3px solid #D4AF37; }
    .game-card.gift-selected::after {
        content: 'üéÅ'; position: absolute; top: 5px; right: 5px;
        background: #D4AF37; width: 30px; height: 30px;
        border-radius: 50%; display: flex; align-items: center; justify-content: center;
    }

    .game-card img { width: 100%; height: 120px; object-fit: cover; background: #f9f9f9; }
    .card-info { padding: 10px; text-align: center; }
    .card-title { font-size: 0.85rem; font-weight: 600; margin-bottom: 5px; line-height: 1.2; }
    .card-price { font-size: 0.9rem; color: #666; }

    /* 4. CHECKOUT FLUTUANTE */
    .checkout-bar {
        position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%) translateY(150%);
        background: #2c3e50; color: white; padding: 12px 25px;
        border-radius: 50px; display: flex; align-items: center; gap: 15px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.4); z-index: 1000;
        transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        width: 90%; max-width: 400px; justify-content: space-between;
    }
    .checkout-bar.visible { transform: translateX(-50%) translateY(0); }

    .btn-zap {
        background: #25D366; color: white; border: none; padding: 10px 20px;
        border-radius: 25px; font-weight: bold; cursor: pointer;
        text-transform: uppercase; font-size: 0.9rem;
    }

    @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
</style>

<!-- O JOGO -->
<div class="game-header" id="header-box">
    <h3>Monte sua ChefBox</h3>
    <div class="progress-bar">
        <div class="slot" id="s0">1</div>
        <div class="slot" id="s1">2</div>
        <div class="slot" id="s2">3</div>
        <div class="slot" id="s3">4</div>
        <div class="slot slot-gift" id="sGift">üéÅ</div>
    </div>
    <p id="status-text" style="font-size: 0.9rem; color: #666;">Escolha 4 pratos para desbloquear o presente.</p>
</div>

<!-- FILTROS (Opcional - melhora UX) -->
<div class="category-filters">
    <button class="filter-btn active" onclick="filter('all')">Todos</button>
    <button class="filter-btn" onclick="filter('risotos')">Risotos</button>
    <button class="filter-btn" onclick="filter('sopas')">Sopas</button>
</div>

<!-- VITRINE DIN√ÇMICA (Conectada ao CMS) -->
<div class="game-grid">
    {# AQUI EST√Å A M√ÅGICA: Loop autom√°tico nos produtos reais #}
    {# Estamos combinando Risotos e Sopas numa lista s√≥ #}
    
    {% for item in collections.risotos %}
        <div class="game-card cat-risotos" 
             onclick="toggleItem(this)" 
             data-id="{{ item.data.sku }}" 
             data-name="{{ item.data.title }}" 
             data-price="{{ item.data.price }}">
            <img src="{{ item.data.image }}" alt="{{ item.data.title }}">
            <div class="card-info">
                <div class="card-title">{{ item.data.title }}</div>
                <div class="card-price">R$ {{ item.data.price }}</div>
            </div>
        </div>
    {% endfor %}

    {% for item in collections.sopas %}
        <div class="game-card cat-sopas" 
             onclick="toggleItem(this)" 
             data-id="{{ item.data.sku }}" 
             data-name="{{ item.data.title }}" 
             data-price="{{ item.data.price }}">
            <img src="{{ item.data.image }}" alt="{{ item.data.title }}">
            <div class="card-info">
                <div class="card-title">{{ item.data.title }}</div>
                <div class="card-price">R$ {{ item.data.price }}</div>
            </div>
        </div>
    {% endfor %}
</div>

<!-- BARRA DE CHECKOUT -->
<div class="checkout-bar" id="checkout">
    <div style="display:flex; flex-direction:column;">
        <span style="font-size:0.7rem; opacity:0.8;">TOTAL DA CAIXA</span>
        <strong id="total-display" style="font-size:1.1rem;">R$ 0,00</strong>
    </div>
    <button class="btn-zap" onclick="finalizarPedido()">PEDIR NO WHATSAPP ‚ûú</button>
</div>

<script>
    // L√ìGICA DO JOGO
    let cart = [];
    let giftItem = null;
    const MAX_ITENS = 4;

    function toggleItem(card) {
        const id = card.dataset.id;
        const name = card.dataset.name;
        const price = parseFloat(card.dataset.price);

        // 1. Verifica se j√° est√° no carrinho (para remover)
        const index = cart.findIndex(i => i.id === id);
        
        if (index > -1) {
            // REMOVER ITEM
            cart.splice(index, 1);
            card.classList.remove('selected');
        } else if (giftItem && giftItem.id === id) {
            // REMOVER PRESENTE
            giftItem = null;
            card.classList.remove('gift-selected');
        } else {
            // ADICIONAR ITEM
            if (cart.length < MAX_ITENS) {
                cart.push({id, name, price});
                card.classList.add('selected');
            } else if (!giftItem) {
                // ADICIONAR COMO PRESENTE
                giftItem = {id, name, price};
                card.classList.add('gift-selected');
            } else {
                // TUDO CHEIO (Feedback visual de erro?)
                alert("Sua caixa j√° est√° cheia! Remova um item para trocar.");
                return;
            }
        }
        updateInterface();
    }

    function updateInterface() {
        // Atualiza Slots 1-4
        for (let i = 0; i < MAX_ITENS; i++) {
            const slot = document.getElementById('s' + i);
            if (cart[i]) {
                slot.classList.add('filled');
                slot.innerText = "‚úì";
            } else {
                slot.classList.remove('filled');
                slot.innerText = i + 1;
            }
        }

        // Atualiza Slot Presente
        const slotGift = document.getElementById('sGift');
        const header = document.getElementById('header-box');
        const status = document.getElementById('status-text');

        if (giftItem) {
            slotGift.classList.add('active');
            slotGift.innerText = "üéÅ";
            header.classList.add('mission-complete');
            status.innerText = "Parab√©ns! Caixa completa.";
            document.getElementById('checkout').classList.add('visible');
        } else {
            slotGift.classList.remove('active');
            slotGift.innerText = "üéÅ";
            header.classList.remove('mission-complete');
            document.getElementById('checkout').classList.remove('visible');
            
            // Texto de ajuda
            if (cart.length < MAX_ITENS) {
                status.innerText = `Escolha mais ${MAX_ITENS - cart.length} sabores.`;
            } else {
                status.innerText = "AGORA CLIQUE NO SEU PRESENTE! (Item Gr√°tis)";
            }
        }

        // Calcula Total (Soma os 4 itens, ignora o presente)
        const total = cart.reduce((acc, item) => acc + item.price, 0);
        document.getElementById('total-display').innerText = total.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});
    }

    function finalizarPedido() {
        if (cart.length < MAX_ITENS || !giftItem) return;

        let msg = "*üç≥ PEDIDO CHEFBOX (5 Itens)*\n\n";
        msg += "*Itens da Caixa:*\n";
        cart.forEach(item => msg += `‚úÖ ${item.name}\n`);
        
        msg += `\nüéÅ *PRESENTE ESCOLHIDO:* ${giftItem.name}\n`;
        msg += `\nüí∞ *Valor Total:* ${document.getElementById('total-display').innerText}`;
        msg += "\n\nPor favor, me envie a chave Pix!";

        const link = `https://wa.me/5561996659880?text=${encodeURIComponent(msg)}`;
        window.open(link, '_blank');
    }

    // Filtro Simples
    function filter(cat) {
        document.querySelectorAll('.game-card').forEach(el => {
            if(cat === 'all' || el.classList.contains('cat-'+cat)) el.style.display = 'block';
            else el.style.display = 'none';
        });
        // Atualiza bot√µes
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');
    }
</script>
