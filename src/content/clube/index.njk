<!--BLOCO DO FORMUL√ÅRIO INTELIGENTE (SEM REDIRECIONAMENTO) -->
<div id="form-container" class="chefbox-offer-card" style="background: white; border: 1px solid #eee; box-shadow: 0 20px 50px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto; padding: 40px; border-radius: 15px;">
    
    <!-- 1. O QUE APARECE ANTES DE ENVIAR -->
    <div id="form-content">
        <h2 style="color: #014039; font-size: 1.8rem; margin-bottom: 10px;">
            Ganhe um Presente Agora! üéÅ
        </h2>
        <p style="color: #666; margin-bottom: 30px;">
            Inscreva-se e receba o cupom <strong>PRIMEIRA10</strong> (10% OFF).
        </p>

        <form id="club-form" name="clube-chefbrico" method="POST" data-netlify="true">
            <input type="hidden" name="form-name" value="clube-chefbrico">
            
            <div style="margin-bottom: 15px; text-align: left;">
                <label style="font-weight: bold; color: #014039; font-size: 0.9rem;">Seu Nome</label>
                <input type="text" name="nome" placeholder="Seu nome" required
                       style="width: 100%; padding: 15px; border: 1px solid #ddd; border-radius: 8px; margin-top: 5px;">
            </div>

            <div style="margin-bottom: 25px; text-align: left;">
                <label style="font-weight: bold; color: #014039; font-size: 0.9rem;">Seu Melhor E-mail</label>
                <input type="email" name="email" placeholder="seu@email.com" required
                       style="width: 100%; padding: 15px; border: 1px solid #ddd; border-radius: 8px; margin-top: 5px;">
            </div>
            
            <button type="submit" class="btn-chefbox" style="width: 100%; padding: 15px; font-size: 1.1rem; cursor: pointer; background: #F2811D; color: white; border: none; border-radius: 50px; font-weight: bold;">
                QUERO MEUS CUPONS! üéüÔ∏è
            </button>
        </form>
        <p id="loading-msg" style="display:none; color:#F2811D; font-weight:bold; margin-top:15px;">Enviando...</p>
    </div>

    <!-- 2. O QUE APARECE DEPOIS DE ENVIAR (SUCESSO) -->
    <div id="success-message" style="display: none; text-align: center; animation: fadeIn 0.5s;">
        <div style="font-size: 4rem;">üéâ</div>
        <h2 style="color: #014039;">Bem-vindo(a)!</h2>
        <p>Cadastro realizado com sucesso.</p>
        
        <div style="background: #fff8e1; border: 2px dashed #bfb084; padding: 20px; margin: 20px 0; border-radius: 10px;">
            <span style="font-size: 2rem; font-weight: 800; color: #27ae60;">PRIMEIRA10</span>
            <p style="margin: 5px 0 0 0; font-size: 0.8rem; color: #888;">(Copie seu cupom)</p>
        </div>

        <a href="/chefbox/" style="display: inline-block; background: #014039; color: white; padding: 12px 30px; border-radius: 50px; text-decoration: none; font-weight: bold;">
            USAR AGORA ‚ûú
        </a>
    </div>

</div>

<!-- SCRIPT M√ÅGICO (Faz a troca sem recarregar a p√°gina) -->
<script>
    const form = document.getElementById('club-form');
    const contentDiv = document.getElementById('form-content');
    const successDiv = document.getElementById('success-message');
    const loadingMsg = document.getElementById('loading-msg');

    form.addEventListener('submit', (e) => {
        e.preventDefault(); // Impede o navegador de tentar mudar de p√°gina
        loadingMsg.style.display = 'block';
        
        let formData = new FormData(form);
        
        fetch('/', {
            method: 'POST',
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: new URLSearchParams(formData).toString()
        })
        .then(() => {
            // Sucesso! Esconde o form e mostra o cupom
            contentDiv.style.display = 'none';
            successDiv.style.display = 'block';
            console.log("Lead Enviado para o Netlify CRM");
        })
        .catch((error) => {
            alert('Erro ao enviar. Tente novamente.');
            loadingMsg.style.display = 'none';
        });
    });
</script>
